# Windows → Linux(TOPST) 이더넷으로 인터넷 공유하기

## 현재 상태
- **Linux(TOPST)**: eth0 = 192.168.137.25, 게이트웨이 = 192.168.137.1
- **게이트웨이(192.168.137.1) ping 실패** → Windows PC와 연결이 안 되는 상태

---

## 1. Windows에서 인터넷 공유(ICS) 설정

### 1) 네트워크 연결 확인
1. **Win + R** → `ncpa.cpl` 입력 → Enter (네트워크 연결 창)
2. 다음 두 개 확인:
   - **인터넷이 되는 연결**: Wi-Fi 또는 다른 이더넷(예: "이더넷")
   - **Linux와 연결된 어댑터**: TOPST와 케이블로 연결한 포트(예: "이더넷 2")

### 2) 인터넷 연결 공유 켜기
1. **인터넷이 되는 연결** (예: Wi-Fi) **우클릭** → **속성**
2. **공유** 탭 이동
3. **"다른 네트워크 사용자가 이 컴퓨터의 인터넷 연결을 통해 연결할 수 있도록 허용"** 체크
4. **홈 네트워크 연결**에서 **Linux와 연결된 어댑터** 선택 (예: 이더넷 2)
5. **확인** 클릭

→ Windows가 해당 이더넷 어댑터에 **192.168.137.1**을 자동으로 부여합니다.

### 3) Windows 방화벽
- ICS를 켜면 Windows가 보통 필요한 규칙을 추가합니다.
- 여전히 안 되면 **제어판 → Windows Defender 방화벽 → 고급 설정**에서  
  **인바운드 규칙**에 **192.168.137.0/24** 또는 **로컬 서브넷** 허용 규칙이 있는지 확인.

---

## 2. Linux(TOPST) 쪽 확인

### 게이트웨이·DNS는 이미 설정됨
- 기본 게이트웨이: 192.168.137.1
- DNS: systemd-resolved 사용 (127.0.0.53)

### Windows ICS 적용 후 테스트
```bash
# 1) 게이트웨이(Windows) ping
ping -c 2 192.168.137.1

# 2) 외부 ping
ping -c 2 8.8.8.8

# 3) DNS 확인
ping -c 2 www.google.com
```

모두 응답하면 `sudo apt update` / `sudo apt install qml` 등 사용 가능합니다.

### DNS가 안 되면 (이름 해석 실패 시)
```bash
# systemd-resolved에 DNS 서버 지정 (8.8.8.8)
sudo resolvectl dns eth0 8.8.8.8 8.8.4.4
# 또는
echo "nameserver 8.8.8.8" | sudo tee /etc/resolv.conf
```

---

## 3. 체크리스트

| 확인 항목 |
|-----------|
| Windows에서 **인터넷 되는 연결** → **Linux 연결된 이더넷**으로 ICS 사용 설정 |
| Windows 이더넷 어댑터 IP가 **192.168.137.1**인지 (ICS 후 자동 설정) |
| Linux에서 `ping 192.168.137.1` 성공 여부 |
| Linux에서 `ping 8.8.8.8` 성공 여부 |

---

## 4. 여전히 안 될 때

1. **케이블**: 다른 랜 케이블로 바꿔 보기.
2. **Windows IP 확인**:  
   CMD에서 `ipconfig` → Linux와 연결된 어댑터가 **192.168.137.1**인지 확인.
3. **Linux IP 확인**:  
   `ip addr show eth0` → 192.168.137.25 대역인지 확인.
4. **수동 IP (Windows)**:  
   ICS 대신, Windows 이더넷을 **192.168.137.1**, 서브넷 **255.255.255.0**로 수동 설정 후, Windows에서 **인터넷이 되는 어댑터**에 ICS를 켜서 **이 이더넷**으로 공유.

이 순서대로 하면 Windows → 이더넷 → Linux(TOPST)로 인터넷을 쓰는 데 필요한 설정입니다.
